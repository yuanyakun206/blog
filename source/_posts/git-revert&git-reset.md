---
layout: git
title: revert
date: 2025-08-14 14:15:03
tags: git
category: git
---
`git revert` 和 `git reset` 是 Git 中用于撤销更改的两个命令，但它们的实现方式和应用场景有显著区别。以下是两者的核心差异：

------

### **1. 对提交历史的影响**

- **git revert**
  - **安全撤销**：通过创建一个新的提交来“逆操作”某个旧提交的更改，**不会修改现有提交历史**。
  - 例如：如果提交 `abc123` 引入了错误，执行 `git revert abc123` 会生成一个新提交，撤销 `abc123` 的改动，但原提交依然保留在历史中，**如果想丢弃abc123，直接revert abc123即可。**
  - **适用场景**：已推送到远程仓库的提交（公共历史）需要撤销时，避免破坏协作。
- **git reset**
  - **重写历史**：直接移动 `HEAD` 指针到指定的提交，丢弃后续提交（默认情况下）。
  - 例如：执行 `git reset --hard abc123` 会丢弃 `abc123` 之后的所有提交，**修改提交历史，如果想丢弃abc123,需要reset其前一个提交**。
  - **适用场景**：仅限本地未推送的提交需要彻底删除时使用（避免在公共分支使用）。

------

### **2. 工作区和暂存区的处理**

- **git revert**
  - 仅生成一个新的撤销提交，**不影响当前工作区和暂存区**的未提交内容。
- **git reset**
  - 根据参数不同，可能影响工作区和暂存区：
    - `--soft`：仅移动 `HEAD`，保留工作区和暂存区的改动。
    - `--mixed`（默认）：移动 `HEAD`，并重置暂存区，但保留工作区改动。
    - `--hard`：彻底丢弃所有改动（包括工作区和暂存区）。

------

### **3. 典型场景对比**

| **场景**               | **git revert**       | **git reset**            |
| ---------------------- | -------------------- | ------------------------ |
| **撤销已推送的提交**   | ✅ 安全，适合公共历史 | ❌ 危险，会重写历史       |
| **撤销未推送的提交**   | ✅ 可用，但可能冗余   | ✅ 高效，彻底删除提交     |
| **协作开发**           | ✅ 不影响他人         | ❌ 可能导致他人同步问题   |
| **仅撤销某个特定提交** | ✅ 精确撤销单个提交   | ❌ 回退到某个时间点的状态 |

------

### **4. 直观示例**

假设提交历史为 `A -> B -> C`：

- **git revert C**：生成新提交 `D`，撤销 `C` 的改动。历史变为 `A -> B -> C -> D`。
- **git reset B`**：丢弃提交 `C`，历史变为 `A -> B`（具体效果取决于 `--soft`/`--mixed`/`--hard`）。

------

### **总结**

- **用 `git revert`**：当需要安全撤销已共享的提交时（如团队协作）。
- **用 `git reset`**：当需要彻底删除本地未推送的提交时（如清理实验性代码）。
- **关键区别**：`revert` 是“添加”撤销操作，而 `reset` 是“删除”提交历史。